---
title: "Analiza_Danych_Projekt_Markdown"
author: "M≈Å"
date: "2025-01-12"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r cars}
summary(cars)
```

## Including Plots

You can also embed plots, for example:

```{r pressure, echo=FALSE}
plot(pressure)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.

```{r}
library(ggplot2)
library(scales)
library(dplyr)

# Compute percentages within each city group
apartments_pct <- czyste %>%
  group_by(city, condition) %>%
  summarise(count = n(), .groups = "drop") %>%
  mutate(percentage = count / sum(count))  # Calculate percentage

# Define color palette
colors <- RColorBrewer::brewer.pal(8, "Set2")  

ggplot(apartments_pct, aes(x = condition, y = percentage, fill = condition)) +
  geom_bar(stat = "identity") +
  geom_text(aes(label = scales::percent(percentage, accuracy = 1)), 
            y = 0.1,  # Fixed height (10%) for all labels
            color = "black", size = 5) +  
  facet_wrap(~ city) +  
  theme_minimal() +
  scale_y_continuous(labels = percent_format(), limits = c(0, 0.2)) +  # Limit Y-axis to 20%
  scale_fill_manual(values = colors) +  
  labs(title = "Condition Distribution Across Cities", x = "Condition", y = "Percentage")

```
```{r}
# aov and interaction plot
# Using aov to assess interaction effects between variables
aov <- aov(price ~ city * condition, data = apartments)
summary(aov)

# Interaction plot
interaction.plot(
  czyste$city,
  czyste$condition,
  czyste$price,
  main = "Interaction Plot: City x Condition",
  xlab = "City",
  ylab = "Average Price",
  col = 1:6
)


```
```{r}
corrplot(correlation_matrix, method = "square", 
         tl.cex = 0.8, cl.cex = 0.8, 
         type = "upper", order = "hclust", 
         addCoef.col = "black", number.cex = 0.7,
         title = "Correlation Heatmap for Selected Variables", mar = c(0, 0, 2, 0))
```
  
  